!function(t){function n(i){if(a[i])return a[i].exports;var e=a[i]={exports:{},id:i,loaded:!1};return t[i].call(e.exports,e,e.exports,n),e.loaded=!0,e.exports}var a={};return n.m=t,n.c=a,n.p="",n(0)}([function(t,n,a){a(1),t.exports=a(10)},function(t,n,a){"use strict";function i(t){t.width=g,t.height=v,document.addEventListener("keydown",function(t){b.keydown(t.keyCode)},!1),document.addEventListener("keyup",function(t){b.keyup(t.keyCode)},!1)}function e(){var t=Date.now(),n=t-z;z=t,d.innerText=Math.floor(1e3/n).toString(),y.fillStyle="#ffffff",y.fillRect(0,0,g,v),y.fillStyle="#000000",y.fillRect(0,x,g,x),k.getcontrols(b,n);for(var a=k.getrays(g),i=0;i<a.length;i++)for(var o=h.Ray.cast(M,k.position,null,null,a[i],20),s=0;s<o.length;s++)if(o[s].type>0){var c=r.DistanceCalc.getdistance(k.position,o[s].point),f=m/(c*Math.cos(.99*(k.facing.angle-a[i].angle)));f=Math.ceil(f>v?v:f);var u=Math.floor(255-10*c);y.putImageData(l.getpxdata(y,f,u,u,u,255),i,x-f/2);break}requestAnimationFrame(e)}var o=a(2),r=a(3),s=a(4),c=a(5),h=a(6),f=a(8),u=a(9),l=new s.WallFactory,p=document.getElementById("gamecanvas"),d=document.getElementById("fps"),y=p.getContext("2d"),g=800,v=600,x=v/2,m=.8*v,w=90,M=new f.Map(100),k=new u.Player({x:M.size/2,y:M.size/2},new c.Angle(0),w*Math.PI/180),b=new o.Controls,z=Date.now();M.randomize(.3),i(p),e()},function(t,n){"use strict";var a=function(){function t(){this.rotateleft=!1,this.rotateright=!1,this.forward=!1,this.backward=!1}return t.prototype.keydown=function(t){37==t&&(this.rotateleft=!0),39==t&&(this.rotateright=!0),38==t&&(this.forward=!0),40==t&&(this.backward=!0)},t.prototype.keyup=function(t){37==t&&(this.rotateleft=!1),39==t&&(this.rotateright=!1),38==t&&(this.forward=!1),40==t&&(this.backward=!1)},t}();n.Controls=a},function(t,n){"use strict";var a=function(){function t(){}return t.getdistance=function(t,n){return Math.sqrt((t.x-n.x)*(t.x-n.x)+(t.y-n.y)*(t.y-n.y))},t}();n.DistanceCalc=a},function(t,n){"use strict";var a=function(){function t(){this.pxdatacache=[]}return t.prototype.getpxdata=function(t,n,a,i,e,o){var r=this.pxdatacache[n];return null==r&&(r=this.createpxdata(t,n,a,i,e,o),this.pxdatacache[n]=r),r},t.prototype.createpxdata=function(t,n,a,i,e,o){for(var r=t.createImageData(1,n),s=0;s<4*n;)r.data[s++]=a,r.data[s++]=i,r.data[s++]=e,r.data[s++]=o;return r},t}();n.WallFactory=a},function(t,n){"use strict";var a=function(){function t(t){this.angle=t,this.sin=Math.sin(t),this.cos=Math.cos(t),this.tg=this.sin/this.cos,this.ctg=this.cos/this.sin,this.dx=this.cos>0?1:0,this.dy=this.sin>0?1:0}return t}();n.Angle=a},function(t,n,a){"use strict";var i=a(7),e=function(){function t(){}return t.nearesty=function(t,n){var a=Math.floor(t.y)+n.dy;a==t.y&&(a-=1);var i=a-t.y,e=n.ctg*i;return{x:e+t.x,y:a,manhattandistance:Math.abs(e)+Math.abs(i)}},t.nearestx=function(t,n){var a=Math.floor(t.x)+n.dx;a==t.x&&(a-=1);var i=a-t.x,e=n.tg*i;return{x:a,y:e+t.y,manhattandistance:Math.abs(i)+Math.abs(e)}},t.cast=function(n,a,e,o,r,s){if(s<1)return[];var c=e||t.nearesty(a,r),h=o||t.nearestx(a,r);return c.manhattandistance<h.manhattandistance?(h.manhattandistance-=c.manhattandistance,[new i.Colision(c,n.getvalue(Math.floor(c.x),c.y-(r.dy>0?0:1)))].concat(t.cast(n,c,null,h,r,s-c.manhattandistance))):(c.manhattandistance-=h.manhattandistance,[new i.Colision(h,n.getvalue(h.x-(r.dx>0?0:1),Math.floor(h.y)))].concat(t.cast(n,h,c,null,r,s-h.manhattandistance)))},t}();n.Ray=e},function(t,n){"use strict";var a=function(){function t(t,n){this.point=t,this.type=n}return t}();n.Colision=a},function(t,n){"use strict";var a=function(){function t(t){this.map=new Uint8Array(t*t),this.size=t}return t.prototype.setvalue=function(t,n,a){var i=this.size*n+t;i<this.map.length&&i>=0&&(this.map[this.size*n+t]=a)},t.prototype.getvalue=function(t,n){if(t>=0&&n>=0&&t<this.size&&n<this.size){var a=this.size*n+t;return this.map[a]}return 0},t.prototype.randomize=function(t){for(var n=0;n<this.map.length;n++)this.map[n]=Math.random()<t?1:0},t}();n.Map=a},function(t,n,a){"use strict";var i=a(5),e=function(){function t(t,n,a){this.position=t,this.facing=n,this.fov=a}return t.prototype.getrays=function(t){for(var n=this.fov/t,a=this.facing.angle+this.fov/2,e=new Array,o=0;o<t;o++)e.push(new i.Angle(a)),a-=n;return e},t.prototype.rotateleft=function(t){this.facing=new i.Angle(this.facing.angle+Math.PI/t)},t.prototype.rotateright=function(t){this.facing=new i.Angle(this.facing.angle-Math.PI/t)},t.prototype.moveforward=function(t){this.position={x:this.position.x+this.facing.cos/t,y:this.position.y+this.facing.sin/t}},t.prototype.movebackward=function(t){this.position={x:this.position.x-this.facing.cos/t,y:this.position.y-this.facing.sin/t}},t.prototype.getcontrols=function(t,n){t.forward&&this.moveforward(n),t.backward&&this.movebackward(n),t.rotateleft&&this.rotateleft(n),t.rotateright&&this.rotateright(n)},t}();n.Player=e},function(t,n){}]);
//# sourceMappingURL=app.bundle.js.map