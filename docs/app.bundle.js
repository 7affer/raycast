!function(t){function i(s){if(e[s])return e[s].exports;var o=e[s]={exports:{},id:s,loaded:!1};return t[s].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}var e={};return i.m=t,i.c=e,i.p="",i(0)}([function(t,i,e){e(1),t.exports=e(13)},function(t,i,e){"use strict";function s(){var t=Date.now(),i=t-P;P=t,C=new Array;for(var e=0;e<M.length;e++)Math.abs(w.position.x-M[e].position.x)<p.drawingdistance&&Math.abs(w.position.y-M[e].position.y)<p.drawingdistance&&(M[e].angle=Math.atan2(w.position.x-M[e].position.x,w.position.y-M[e].position.y),C.push(M[e]));w.getcontrols(m,y,i),x.renderframe(i,y,w,C),requestAnimationFrame(s),f.innerText=Math.floor(1e3/i).toString()}for(var o=e(2),n=e(3),r=e(4),a=e(8),h=e(9),c=e(10),l=e(11),f=document.getElementById("fps"),u=window.innerWidth<1024?window.innerWidth:1024,p={width:u,height:Math.floor(u/1.8),fov:70*Math.PI/180,drawingdistance:25,floorcolor1:"#000011",floorcolor2:"#111122"},d=document.getElementById("gamecanvas"),g=d.getContext("2d"),y=new c.Map(1e3,.3),w=new l.Player({x:y.size/2+.25,y:y.size/2+.25},new h.Angle(0),p.fov),m=new a.Controls,v=new n.AssetLoader,x=new r.Scene(g,p,v),M=new Array,k=0;k<50;k++)M.push(new o.Sprite({x:100*Math.random(),y:100*Math.random()},0));d.width=p.width,d.height=p.height,d.style.width=p.width+"px",d.style.height=p.height+"px",m.bindevents(document,d),w.initonmap(y);var C=new Array,P=Date.now();v.loadall(s)},function(t,i){"use strict";var e=function(){function t(t,i){this.position=t,this.type=i}return t}();i.Sprite=e},function(t,i){"use strict";var e=function(){function t(){this.loaded=0,this.wallssrcs=["./assets/walls/wall1.jpg","./assets/walls/wall2.jpg","./assets/walls/wall3.jpg","./assets/walls/wall4.jpg","./assets/walls/wall5.jpg"],this.walls=new Array;for(var t in this.wallssrcs)this.walls.push(new Image);this.spritessrcs=["./assets/sprites/sprite1.png","./assets/sprites/sprite2.png","./assets/sprites/sprite3.png","./assets/sprites/sprite4.png","./assets/sprites/sprite5.png"],this.sprites=new Array;for(var t in this.spritessrcs)this.sprites.push(new Image)}return t.prototype.isloaded=function(){return this.loaded==this.walls.length+this.sprites.length},t.prototype.loadall=function(t){var i=this;for(var e in this.wallssrcs)this.walls[e].onload=function(){i.loaded+=1,i.isloaded()&&t()},this.walls[e].src=this.wallssrcs[e];for(var e in this.spritessrcs)this.sprites[e].onload=function(){i.loaded+=1,i.isloaded()&&t()},this.sprites[e].src=this.spritessrcs[e]},t}();i.AssetLoader=e},function(t,i,e){"use strict";var s=e(5),o=e(7),n=function(){function t(t,i,e){this.ctx=t,this.settings=i,this.assets=e,this.lastrender=Date.now(),this.height2=Math.floor(i.height/2),this.wallheight=Math.floor(.8*i.height)}return t.prototype.renderbackground=function(){var t=this.ctx.createLinearGradient(0,0,0,this.height2);t.addColorStop(0,"#aaaaaa"),t.addColorStop(1,"#222222"),this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.settings.width,this.height2),this.ctx.fillStyle=this.settings.floorcolor1,this.ctx.fillRect(0,this.height2,this.settings.width,this.settings.height)},t.prototype.renderwall=function(t,i,e,s){var o=Math.ceil(this.wallheight/i),n=Math.floor(this.height2-o/2),r=Math.floor(s*e.width);this.ctx.drawImage(e,r,0,1,e.height,t,n,1,o),t%3==0&&(this.ctx.beginPath(),this.ctx.moveTo(t,n),this.ctx.lineTo(t,this.settings.height-n),this.ctx.lineWidth=4,this.ctx.strokeStyle="#000000",this.ctx.fillStyle="#000000",this.ctx.globalAlpha=i/this.settings.drawingdistance,this.ctx.stroke(),this.ctx.globalAlpha=1)},t.prototype.drawwall=function(t,i,e,s){var o=e.point.x-Math.floor(e.point.x),n=e.point.y-Math.floor(e.point.y),r=Math.abs(o>n?o:n);this.renderwall(t,i,this.assets.walls[e.type-1],r)},t.prototype.drawfloor=function(t,i,e,s){var o=Math.ceil(this.wallheight/i),n=Math.floor(this.settings.height-(this.height2-o/2));return s&&t%3==0&&(this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(t,n),this.ctx.lineWidth=4,this.ctx.strokeStyle=this.settings.floorcolor2,this.ctx.stroke()),n},t.prototype.renderframe=function(t,i,e,n){this.renderbackground();for(var r=e.getrays(this.settings.width),a=(Math.floor(e.position.x)+Math.floor(e.position.y))%2==0,h=0;h<r.length;h++)for(var c=this.settings.height,l=a,f=void 0,u=Math.cos(e.facing.angle-r[h].angle),p=s.Ray.cast(i,e.position,null,null,r[h],this.settings.drawingdistance),d=0;d<p.length;d++){var g=o.DistanceCalc.getdistance(e.position,p[d].point)*u;p[d].type>0&&(f=p[d],this.drawwall(h,g,f,e)),c=this.drawfloor(h,g,c,l),l=!l}},t}();i.Scene=n},function(t,i,e){"use strict";var s=e(6),o=function(){function t(){}return t.nearesty=function(t,i){var e=Math.floor(t.y+i.dy);e==t.y&&(e-=1);var s=e-t.y,o=i.ctg*s;return{x:o+t.x,y:e,manhattandistance:Math.abs(o)+Math.abs(s)}},t.nearestx=function(t,i){var e=Math.floor(t.x+i.dx);e==t.x&&(e-=1);var s=e-t.x,o=i.tg*s;return{x:e,y:o+t.y,manhattandistance:Math.abs(s)+Math.abs(o)}},t.cast=function(i,e,o,n,r,a){if(a<1)return[];var h=o||t.nearesty(e,r),c=n||t.nearestx(e,r);if(h.manhattandistance<c.manhattandistance){c.manhattandistance-=h.manhattandistance;var l=i.getvalue(Math.floor(h.x),h.y-(r.dy>0?0:1));return l>0?[new s.Colision(h,l)]:[new s.Colision(h,l)].concat(t.cast(i,h,null,c,r,a-h.manhattandistance))}h.manhattandistance-=c.manhattandistance;var l=i.getvalue(c.x-(r.dx>0?0:1),Math.floor(c.y));return l>0?[new s.Colision(c,l)]:[new s.Colision(c,l)].concat(t.cast(i,c,h,null,r,a-c.manhattandistance))},t}();i.Ray=o},function(t,i){"use strict";var e=function(){function t(t,i){this.point=t,this.type=i}return t}();i.Colision=e},function(t,i){"use strict";var e=function(){function t(){}return t.getdistance=function(t,i){return Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y))},t}();i.DistanceCalc=e},function(t,i){"use strict";var e=function(){function t(){var t=this;this.rotateleft=!1,this.rotateright=!1,this.forward=!1,this.backward=!1,this.run=!1,this.strafeleft=!1,this.straferight=!1,this.mouserotateleft=0,this.mouserotateright=0,this.mousemovefunction=function(i){return t.mousemove(i)}}return t.prototype.mousemove=function(t){t.movementX<0?(this.mouserotateleft=-t.movementX/5,this.mouserotateright=0):t.movementX>0&&(this.mouserotateleft=0,this.mouserotateright=t.movementX/5)},t.prototype.resetmouserotate=function(){this.mouserotateleft=0,this.mouserotateright=0},t.prototype.keydown=function(t){37==t.keyCode&&(this.rotateleft=!0),68==t.keyCode&&(this.strafeleft=!0),39==t.keyCode&&(this.rotateright=!0),65==t.keyCode&&(this.straferight=!0),38!=t.keyCode&&87!=t.keyCode||(this.forward=!0),40!=t.keyCode&&83!=t.keyCode||(this.backward=!0),this.run=t.shiftKey},t.prototype.touchstart=function(t){var i=t.touches[0];this.touchend(t),i.pageX<.333*window.innerWidth?this.rotateleft=!0:i.pageX<.666*window.innerWidth?this.forward=!0:this.rotateright=!0,t.preventDefault(),t.stopPropagation()},t.prototype.touchend=function(t){this.rotateleft=!1,this.rotateright=!1,this.forward=!1,t.preventDefault(),t.stopPropagation()},t.prototype.keyup=function(t){37==t.keyCode&&(this.rotateleft=!1),68==t.keyCode&&(this.strafeleft=!1),39==t.keyCode&&(this.rotateright=!1),65==t.keyCode&&(this.straferight=!1),38!=t.keyCode&&87!=t.keyCode||(this.forward=!1),40!=t.keyCode&&83!=t.keyCode||(this.backward=!1),this.run=t.shiftKey},t.prototype.bindevents=function(t,i){var e=this;t.addEventListener("keydown",function(t){return e.keydown(t)},!1),t.addEventListener("keyup",function(t){return e.keyup(t)},!1),t.addEventListener("pointerlockchange",function(s){e.lockChangeAlert(t,i)},!1),i.addEventListener("touchstart",function(t){e.touchstart(t)},!1),i.addEventListener("touchend",function(t){e.touchend(t)},!1),i.addEventListener("click",function(t){i.requestPointerLock=i.requestPointerLock,i.requestPointerLock()},!1)},t.prototype.lockChangeAlert=function(t,i){var e=document.getElementById("gamecanvas");t.pointerLockElement===e?t.addEventListener("mousemove",this.mousemovefunction,!1):t.removeEventListener("mousemove",this.mousemovefunction,!1)},t}();i.Controls=e},function(t,i){"use strict";var e=function(){function t(t){this.angle=t,this.sin=Math.sin(t),this.cos=Math.cos(t),this.tg=this.sin/this.cos,this.ctg=this.cos/this.sin,this.dx=this.cos>0?1:0,this.dy=this.sin>0?1:0}return t}();i.Angle=e},function(t,i){"use strict";var e=function(){function t(t,i){this.map=new Uint8Array(t*t),this.size=t,this.randomize(i)}return t.prototype.setvalue=function(t,i,e){var s=this.size*i+t;s<this.map.length&&s>=0&&(this.map[this.size*i+t]=e)},t.prototype.getvalue=function(t,i){if(t>=0&&i>=0&&t<this.size&&i<this.size){var e=this.size*i+t;return this.map[e]}return 0},t.prototype.randomize=function(t){for(var i=0;i<this.map.length;i++)Math.random()<t?Math.random()<.1?this.map[i]=5:Math.random()<.1?this.map[i]=4:Math.random()<.3?this.map[i]=3:Math.random()<.5?this.map[i]=2:this.map[i]=1:this.map[i]=0},t}();i.Map=e},function(t,i,e){"use strict";var s=e(12),o=e(9),n=function(){function t(t,i,e){this.position=t,this.facing=i,this.fov=e}return t.prototype.getrays=function(t){for(var i=this.fov/t,e=this.facing.angle+this.fov/2,s=new Array,n=0;n<t;n++)s.push(new o.Angle(e)),e-=i;return s},t.prototype.rotateleft=function(t,i){this.facing=new o.Angle(this.facing.angle+Math.PI*i*t/1200)},t.prototype.rotateright=function(t,i){this.facing=new o.Angle(this.facing.angle-Math.PI*i*t/1200)},t.prototype.correctposition=function(t,i){return t.getvalue(Math.floor(i.x),Math.floor(this.position.y))>0&&(i.x=this.position.x),t.getvalue(Math.floor(this.position.x),Math.floor(i.y))>0&&(i.y=this.position.y),i},t.prototype.moveforward=function(t,i,e){var s={x:this.position.x+this.facing.cos*t/(e?250:500),y:this.position.y+this.facing.sin*t/(e?250:500)};this.position=this.correctposition(i,s)},t.prototype.movebackward=function(t,i){var e={x:this.position.x-this.facing.cos*t/500,y:this.position.y-this.facing.sin*t/500};this.position=this.correctposition(i,e)},t.prototype.strafeleft=function(t,i,e){var n=new o.Angle(this.facing.angle-s.PI0_5),r={x:this.position.x+n.cos*t/(e?250:500),y:this.position.y+n.sin*t/(e?250:500)};this.position=this.correctposition(i,r)},t.prototype.straferight=function(t,i,e){var n=new o.Angle(this.facing.angle+s.PI0_5),r={x:this.position.x+n.cos*t/(e?250:500),y:this.position.y+n.sin*t/(e?250:500)};this.position=this.correctposition(i,r)},t.prototype.initonmap=function(t){for(;t.getvalue(Math.floor(this.position.x),Math.floor(this.position.y))>0;)this.position.x+=1},t.prototype.getcontrols=function(t,i,e){t.forward&&this.moveforward(e,i,t.run),t.backward&&this.movebackward(e,i),t.rotateleft&&this.rotateleft(e,1),t.rotateright&&this.rotateright(e,1),t.mouserotateleft&&this.rotateleft(e,t.mouserotateleft),t.mouserotateright&&this.rotateright(e,t.mouserotateright),t.strafeleft&&this.strafeleft(e,i,t.run),t.straferight&&this.straferight(e,i,t.run),t.resetmouserotate()},t}();i.Player=n},function(t,i){"use strict";i.PI0_5=Math.PI/2,i.PI1_0=Math.PI,i.PI1_5=3*Math.PI/2,i.PI2_0=2*Math.PI},function(t,i){}]);
//# sourceMappingURL=app.bundle.js.map