!function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){i(1),t.exports=i(12)},function(t,e,i){"use strict";function n(){x.renderframe(),requestAnimationFrame(n)}var o=i(2),s=i(3),a=i(7),r=i(8),h=i(9),c=i(10),f=document.getElementById("fps"),l=window.innerWidth<1024?window.innerWidth:1024,u={width:l,height:Math.floor(l/1.8),fov:70*Math.PI/180,drawingdistance:25},p={renderfps:function(t){f.innerText=Math.floor(t).toString()}},d=document.getElementById("gamecanvas"),g=d.getContext("2d"),y=new h.Map(1e3,.3),m=new c.Player({x:y.size/2+.25,y:y.size/2+.25},new r.Angle(0),u.fov),v=new a.Controls,w=new o.AssetLoader,x=new s.Scene(g,y,m,v,u,p,w);d.width=u.width,d.height=u.height,d.style.width=u.width+"px",d.style.height=u.height+"px",v.bindevents(document,d),m.initonmap(y),w.loadall(n)},function(t,e){"use strict";var i=function(){function t(){this.loaded=0,this.wallssrcs=["./assets/wall1.jpg","./assets/wall2.jpg","./assets/wall3.jpg","./assets/wall4.jpg","./assets/wall5.jpg"],this.walls=[new Image,new Image,new Image,new Image,new Image]}return t.prototype.loadall=function(t){var e=this;for(var i in this.wallssrcs)this.walls[i].onload=function(){e.loaded+=1,e.loaded==e.wallssrcs.length&&t()},this.walls[i].src=this.wallssrcs[i]},t}();e.AssetLoader=i},function(t,e,i){"use strict";var n=i(4),o=i(6),s=function(){function t(t,e,i,n,o,s,a){this.ctx=t,this.map=e,this.player=i,this.controls=n,this.settings=o,this.events=s,this.assets=a,this.lastrender=Date.now(),this.height2=Math.floor(o.height/2),this.wallheight=Math.floor(.8*o.height)}return t.prototype.renderbackground=function(){this.ctx.fillStyle="#ffffff",this.ctx.fillRect(0,0,this.settings.width,this.settings.height),this.ctx.fillStyle="#000000",this.ctx.fillRect(0,this.height2,this.settings.width,this.height2)},t.prototype.renderwall=function(t,e,i,n){var o=Math.ceil(this.wallheight/e),s=Math.floor(this.height2-o/2),a=Math.floor(n*i.width);this.ctx.drawImage(i,a,0,1,i.height,t,s,1,o),this.ctx.beginPath(),this.ctx.moveTo(t,s),this.ctx.lineTo(t,this.settings.height-s),this.ctx.lineWidth=2,this.ctx.strokeStyle="#000000",this.ctx.globalAlpha=e/this.settings.drawingdistance,this.ctx.stroke(),this.ctx.globalAlpha=1},t.prototype.renderframe=function(){var t=Date.now(),e=t-this.lastrender;this.lastrender=t,this.events.renderfps(Math.floor(1e3/e)),this.renderbackground(),this.player.getcontrols(this.controls,this.map,e);for(var i=this.player.getrays(this.settings.width),s=0;s<i.length;s++)for(var a=n.Ray.cast(this.map,this.player.position,null,null,i[s],this.settings.drawingdistance),r=0;r<a.length;r++)if(a[r].type>0){var h=a[r].point.x-Math.floor(a[r].point.x),c=a[r].point.y-Math.floor(a[r].point.y),f=Math.abs(h>c?h:c),l=o.DistanceCalc.getdistance(this.player.position,a[r].point),u=l*Math.cos(this.player.facing.angle-i[s].angle);this.renderwall(s,u,this.assets.walls[a[r].type-1],f);break}},t}();e.Scene=s},function(t,e,i){"use strict";var n=i(5),o=function(){function t(){}return t.nearesty=function(t,e){var i=Math.floor(t.y+e.dy);i==t.y&&(i-=1);var n=i-t.y,o=e.ctg*n;return{x:o+t.x,y:i,manhattandistance:Math.abs(o)+Math.abs(n)}},t.nearestx=function(t,e){var i=Math.floor(t.x+e.dx);i==t.x&&(i-=1);var n=i-t.x,o=e.tg*n;return{x:i,y:o+t.y,manhattandistance:Math.abs(n)+Math.abs(o)}},t.cast=function(e,i,o,s,a,r){if(r<1)return[];var h=o||t.nearesty(i,a),c=s||t.nearestx(i,a);return h.manhattandistance<c.manhattandistance?(c.manhattandistance-=h.manhattandistance,[new n.Colision(h,e.getvalue(Math.floor(h.x),h.y-(a.dy>0?0:1)))].concat(t.cast(e,h,null,c,a,r-h.manhattandistance))):(h.manhattandistance-=c.manhattandistance,[new n.Colision(c,e.getvalue(c.x-(a.dx>0?0:1),Math.floor(c.y)))].concat(t.cast(e,c,h,null,a,r-c.manhattandistance)))},t}();e.Ray=o},function(t,e){"use strict";var i=function(){function t(t,e){this.point=t,this.type=e}return t}();e.Colision=i},function(t,e){"use strict";var i=function(){function t(){}return t.getdistance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},t}();e.DistanceCalc=i},function(t,e){"use strict";var i=function(){function t(){var t=this;this.rotateleft=!1,this.rotateright=!1,this.forward=!1,this.backward=!1,this.run=!1,this.strafeleft=!1,this.straferight=!1,this.mouserotateleft=0,this.mouserotateright=0,this.mousemovefunction=function(e){return t.mousemove(e)}}return t.prototype.mousemove=function(t){t.movementX<0?(this.mouserotateleft=-t.movementX/5,this.mouserotateright=0):t.movementX>0&&(this.mouserotateleft=0,this.mouserotateright=t.movementX/5)},t.prototype.resetmouserotate=function(){this.mouserotateleft=0,this.mouserotateright=0},t.prototype.keydown=function(t){37==t.keyCode&&(this.rotateleft=!0),68==t.keyCode&&(this.strafeleft=!0),39==t.keyCode&&(this.rotateright=!0),65==t.keyCode&&(this.straferight=!0),38!=t.keyCode&&87!=t.keyCode||(this.forward=!0),40!=t.keyCode&&83!=t.keyCode||(this.backward=!0),this.run=t.shiftKey},t.prototype.touchstart=function(t){var e=t.touches[0];this.touchend(t),e.pageX<.333*window.innerWidth?this.rotateleft=!0:e.pageX<.666*window.innerWidth?this.forward=!0:this.rotateright=!0,t.preventDefault(),t.stopPropagation()},t.prototype.touchend=function(t){t.touches[0];this.rotateleft=!1,this.rotateright=!1,this.forward=!1,t.preventDefault(),t.stopPropagation()},t.prototype.keyup=function(t){37==t.keyCode&&(this.rotateleft=!1),68==t.keyCode&&(this.strafeleft=!1),39==t.keyCode&&(this.rotateright=!1),65==t.keyCode&&(this.straferight=!1),38!=t.keyCode&&87!=t.keyCode||(this.forward=!1),40!=t.keyCode&&83!=t.keyCode||(this.backward=!1),this.run=t.shiftKey},t.prototype.bindevents=function(t,e){var i=this;t.addEventListener("keydown",function(t){return i.keydown(t)},!1),t.addEventListener("keyup",function(t){return i.keyup(t)},!1),t.addEventListener("pointerlockchange",function(n){i.lockChangeAlert(t,e)},!1),t.addEventListener("touchstart",function(t){i.touchstart(t)},!1),t.addEventListener("touchend",function(t){i.touchend(t)},!1),e.addEventListener("click",function(t){e.requestPointerLock=e.requestPointerLock,e.requestPointerLock()},!1)},t.prototype.lockChangeAlert=function(t,e){var i=document.getElementById("gamecanvas");t.pointerLockElement===i?t.addEventListener("mousemove",this.mousemovefunction,!1):t.removeEventListener("mousemove",this.mousemovefunction,!1)},t}();e.Controls=i},function(t,e){"use strict";var i=function(){function t(t){this.angle=t,this.sin=Math.sin(t),this.cos=Math.cos(t),this.tg=this.sin/this.cos,this.ctg=this.cos/this.sin,this.dx=this.cos>0?1:0,this.dy=this.sin>0?1:0}return t}();e.Angle=i},function(t,e){"use strict";var i=function(){function t(t,e){this.map=new Uint8Array(t*t),this.size=t,this.randomize(e)}return t.prototype.setvalue=function(t,e,i){var n=this.size*e+t;n<this.map.length&&n>=0&&(this.map[this.size*e+t]=i)},t.prototype.getvalue=function(t,e){if(t>=0&&e>=0&&t<this.size&&e<this.size){var i=this.size*e+t;return this.map[i]}return 0},t.prototype.randomize=function(t){for(var e=0;e<this.map.length;e++)Math.random()<t?Math.random()<.1?this.map[e]=5:Math.random()<.1?this.map[e]=4:Math.random()<.3?this.map[e]=3:Math.random()<.5?this.map[e]=2:this.map[e]=1:this.map[e]=0},t}();e.Map=i},function(t,e,i){"use strict";var n=i(11),o=i(8),s=function(){function t(t,e,i){this.position=t,this.facing=e,this.fov=i}return t.prototype.getrays=function(t){for(var e=this.fov/t,i=this.facing.angle+this.fov/2,n=new Array,s=0;s<t;s++)n.push(new o.Angle(i)),i-=e;return n},t.prototype.rotateleft=function(t,e){this.facing=new o.Angle(this.facing.angle+Math.PI*e*t/1200)},t.prototype.rotateright=function(t,e){this.facing=new o.Angle(this.facing.angle-Math.PI*e*t/1200)},t.prototype.correctposition=function(t,e){return t.getvalue(Math.floor(e.x),Math.floor(this.position.y))>0&&(e.x=this.position.x),t.getvalue(Math.floor(this.position.x),Math.floor(e.y))>0&&(e.y=this.position.y),e},t.prototype.moveforward=function(t,e,i){var n={x:this.position.x+this.facing.cos*t/(i?250:500),y:this.position.y+this.facing.sin*t/(i?250:500)};this.position=this.correctposition(e,n)},t.prototype.movebackward=function(t,e){var i={x:this.position.x-this.facing.cos*t/500,y:this.position.y-this.facing.sin*t/500};this.position=this.correctposition(e,i)},t.prototype.strafeleft=function(t,e,i){var s=new o.Angle(this.facing.angle-n.PI0_5),a={x:this.position.x+s.cos*t/(i?250:500),y:this.position.y+s.sin*t/(i?250:500)};this.position=this.correctposition(e,a)},t.prototype.straferight=function(t,e,i){var s=new o.Angle(this.facing.angle+n.PI0_5),a={x:this.position.x+s.cos*t/(i?250:500),y:this.position.y+s.sin*t/(i?250:500)};this.position=this.correctposition(e,a)},t.prototype.initonmap=function(t){for(;t.getvalue(Math.floor(this.position.x),Math.floor(this.position.y))>0;)this.position.x+=1},t.prototype.getcontrols=function(t,e,i){t.forward&&this.moveforward(i,e,t.run),t.backward&&this.movebackward(i,e),t.rotateleft&&this.rotateleft(i,1),t.rotateright&&this.rotateright(i,1),t.mouserotateleft&&this.rotateleft(i,t.mouserotateleft),t.mouserotateright&&this.rotateright(i,t.mouserotateright),t.strafeleft&&this.strafeleft(i,e,t.run),t.straferight&&this.straferight(i,e,t.run),t.resetmouserotate()},t}();e.Player=s},function(t,e){"use strict";e.PI0_5=Math.PI/2,e.PI1_0=Math.PI,e.PI1_5=3*Math.PI/2,e.PI2_0=2*Math.PI},function(t,e){}]);
//# sourceMappingURL=app.bundle.js.map